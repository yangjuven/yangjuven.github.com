
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Alias与WSGIScriptAlias - On the road</title>
  <meta name="author" content="Yang Juven">

  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1.0,  minimum-scale=1.0,  maximum-scale=1.0,  user-scalable=no"/>

  <link rel="canonical" href="">
  <link href="/favicon.png" rel="icon">
  
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  
  <link href="/atom.xml" rel="alternate" title="On the road" type="application/atom+xml">
</head>

<body  >
  <article class="hentry" role="article">
  
    <header>
      
        <h1 class="entry-title">Alias与WSGIScriptAlias</h1>
      
      
        <p class="meta">
          








  


<time datetime="2010-11-18T00:00:00+08:00" pubdate data-updated="true">Nov 18<span>th</span>, 2010</time>
          
  

Posted by <a href="http://yangjuven.github.com/">Yang Juven</a>

          
           | <a href="#disqus_thread">Comments</a>
          
        </p>
      
    </header>
  
  
  <div class="entry-content"><p>将在项目托管到igor中，由于Apache这样配置：</p>

<div><table class="CodeRay"><tr>
  <td class="line-numbers"><pre><a href="#n1" name="n1">1</a>
<a href="#n2" name="n2">2</a>
<a href="#n3" name="n3">3</a>
<a href="#n4" name="n4">4</a>
<a href="#n5" name="n5">5</a>
</pre></td>
  <td class="code"><pre>Alias /project_name/images/ /home/project/project_name/htdocs/images/
Alias /project_name/css/ /home/project/project_name/htdocs/css/
Alias /project_name/js/ /home/project/project_name/htdocs/js/
AliasMatch ^/project_name/(?!app/)(.*) /home/project/project_name/htdocs/$1
WSGIScriptAlias /project_name/app /home/project/project_name/wsgi_handler.py
</pre></td>
</tr></table>
</div>

<p>就出现以下问题：</p>

<ol>
  <li>http://domain/project_name/app</li>
  <li>http://domain/proejct_name/app/</li>
</ol>

<p>链接1和链接2是不同的，链接1会指向到/home/project/htdocs/app，而链接2则会交由wsgi_handler.py来处理。但是实际上我们希望1和2是等价的。那么这个问题也有两种解决方案：</p>

<ol>
  <li>
    <table>
      <tbody>
        <tr>
          <td>修改AliasMatch的正则表达式，修改成”/proect_name/((?!app).*</td>
          <td>app(?!/).+)”</td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>将WSGIScriptAlias 放到AliasMatch前面</li>
</ol>

<p>方案1是可行的。方案2我原以为是可用性的，原因(from
<a href="http://httpd.apache.org/docs/2.0/mod/mod_alias.html">http://httpd.apache.org/docs/2.0/mod/mod_alias.html</a>)：</p>

<blockquote>
  <p>Aliases and Redirects occuring in different contexts are processed
like other directives according to standard merging rules. But when
multiple Aliases or Redirects occur in the same context (for example,
in the same &lt;VirtualHost&gt; section) they are processed in a particular
order.</p>

  <p>First, all Redirects are processed before Aliases are processed, and
therefore a request that matches a Redirect or RedirectMatch will
never have Aliases applied. Second, the Aliases and Redirects are
processed in the order they appear in the configuration files, with
the first match taking precedence.</p>
</blockquote>

<p>但是经过验证，不可行，我就怀疑
Alias和WSGIScriptAlias的优先级了，google了下，的确有人说Alias要比WSGIScriptAlias的优先级要高。在官方文档只找到这句话(from
<a href="http://code.google.com/p/modwsgi/wiki/ConfigurationGuidelines">http://code.google.com/p/modwsgi/wiki/ConfigurationGuidelines</a>)</p>

<blockquote>
  <p>When listing the directives, list those for more specific URLs first.
In practice this shouldn’t actually be required as the Alias directive
should take precedence over WSGIScriptAlias, but good practice all the
same.
\
Do note though that if using Apache 1.3, the Alias directive will only
take precedence over WSGIScriptAlias if the mod_wsgi module is loaded
prior to the mod_alias module. To ensure this, the
LoadModule/AddModule directives are used. For more details see section
‘Alias Directives And Apache 1.3’ in Installation Issues.</p>
</blockquote>

</div>
  
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>


  

<script type="text/javascript">
      var disqus_shortname = 'qiusuo';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://yangjuven.github.com/blog/2010/11/18/alias-and-wsgiscriptalias/';
        var disqus_url = 'http://yangjuven.github.com/blog/2010/11/18/alias-and-wsgiscriptalias/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


</body>
</html>
